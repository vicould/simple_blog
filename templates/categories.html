{% extends "home.html" %}

{% block extra_title %}Categories{% endblock %}
{% block page_head %}
{% if logged_in %}
<script src="/static/categories_edition.js" type="text/javascript" charset="utf-8"></script>
{% endif %}
{% endblock %}

{% block page_content %}
<div id="categories_list">
  {% for category in categories %}
  <div class="category_container">
    <div class="category_title">
      {% if logged_in %}
      <h2 id="{{ category }}"><a href="{{ url_for('view_category', category_name=category) }}">Category <span class="category_name">{{ category }}</span></a> <a href="#" title="Edit category name" class="hidden_link category_edition">edit</a></h2>
      {% else %}
      <h2><a href="{{ url_for('view_category', category_name=category) }}">Category {{ category }}</a></h2>
      {% endif %}
    </div>
    <div class="articles_container">
      {% for article in categories[category] %}
      <article class="article_excerpt grid_element">
        {% if logged_in %}
        <h3><a href="{{ url_for('view_article', article_id=article.id) }}">{{ article.title}}</a> <a href="{{ url_for('edit_article', article_id=article.id) }}" class="hidden_link">edit</a></h3>
        {% else %}
        <h3><a href="{{ url_for('view_article', article_id=article.id) }}">{{ article.title}}</a></h3>
        {% endif %}
        <div class="article_metadata">
          <time datetime="{{ article.date_posted }}" pubdate>{{ article.readable_date }}</time>
        </div>
        <div class="article_content_wrapper">
          {{ article.content|safe }}...<a href="{{ url_for('view_article', article_id=article.id) }}" class="visible_link">[Read more]</a>
        </div>
      </article>
      {% endfor %}
    </div>
  </div>
  <div class="flush">
  {% endfor %}
</div>
{% endblock %}

